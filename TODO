TODO

These are in in priority order, top is highest.
Once they're DONE, move to bottom, and edit or delete.

---------
finish printk cleanup

most now converted, at least partly:
- printk("acx: ...")		to pr_acx("...")	[1]
- printk("acxusb: ...")		to pr_acxusb("...")	[1]
- printk("acxmem: ...")		to pr_acxmem("...")	[1]
- printk("...")			to pr_info("...")

[1] these defined to pr_info separately, allowing separate treatment

---------
de-duplicate pci.c & mem.c

diff -wbB --ifdef=FOO pci.c mem.c > uni-pci-mem.c
produces an ugly but possibly usable file.

jimc@chumly:~/projects/lx/acx-mac80211$ diff mem.c pci.c |wc
   6775   28665  206590
jimc@chumly:~/projects/lx/acx-mac80211$ diff -wb mem.c pci.c |wc
   5730   23760  170424
jimc@chumly:~/projects/lx/acx-mac80211$ diff -wbB mem.c pci.c |wc
   5642   23672  169865
jimc@chumly:~/projects/lx/acx-mac80211$ diff -wbBE mem.c pci.c |wc
   5642   23672  169865

sdiff -WbBE -w150 -l pci.c mem.c  # shows it more clearly:
overlaps in top-down order:

// Data Access - whitespace
static void acxpci_log_rxbuffer(const acx_device_t * adev)
static void acxpci_log_txbuffer(const acx_device_t * adev)

BOM Data Access
INLINE_IO - mem has additional blocks.

acx(pci|mem)_upload_radio(): DONE
	filename diffs only, #if0d in pci|mem, done
	called from common.c:acx_init_mac
	calls acx(pci|mem)_write_fw - TODO		     

acx(pci|mem)_read_phy_reg(): DONE
	Note: define acxdev_lock() mem ? acxmem_lock " void 0
	Later: look at acxusb_read_phy_reg()

acx(pci|mem)_irq_(enable|disable): DONE

acx(pci|mem)_op_(start|stop): DONE

acx(pci|mem)_read_eeprom_byte(): DONE
acx(pci|mem)_proc_eeprom_output(): DONE

DONE: #if1d in mem.c, #if0d in merge.c pending proper merging
  int acxmem_write_fw(acx_device_t *adev,
  acxmem_issue_cmd_timeo_debug(acx_device_t *adev, unsigned cmd,
  int acxmem_reset_dev(acx_device_t *adev)

acx(pci|mem)_up(): DONE
acx(pci|mem)_handle_info_irq(): DONE
acx(pci|mem)_set_interrupt_mask(): DONE

acx(pci|mem)_irq_work():
  diffs around ITERATE

acx(pci|mem)_delete_dma_regions():
	whitespace, comment diffs
	called 2x from #if0d merge.c:acxmem_probe()
	
acxmem_tx_data():
  extra locking
  acx(pci|mem)_get_txhostdesc() usage
  slave_mem - need wrappers 

acxmem_tx_clean_txdesc():
  extra tmpdesc stuff
  acx(pci|mem)_get_txdesc - look at it.
  slave-mem

acxmem_tx_clean_txdesc_emergency():
  acx(pci|mem)_get_txdesc - look at it.
  slave-mem
  maybe make a helper for above.
  grody diffs

OTHERS

acxmem_issue_cmd_timeo_debug():
  has locking adds
  counter goofiness, cruft
  copy-to-slave
  acxpci_write_cmd_type_status(adev, 0, 0);
    VS acxmem_write_cmd_type_status(adev, ACX1xx_CMD_RESET, 0);


acxmem_reset_dev():

acxpci_init_mboxes():

acxmem_proc_diag_output():
  grody diffs

acx(pci|mem)_write_phy_reg()
  copied from mem.c, but needs work before use

acx(pci|mem)_read_eeprom_byte()
acx(pci|mem)_write_eeprom_byte()  (UNUSED)

acx(pci|mem)_s_write_fw()
acx(pci|mem)_s_validate_fw()
acx_show_card_eeprom_id()
acx(pci|mem)_issue_cmd_timeo_debug() fair divergence
acx(pci|mem)_init_mboxes()
acx(pci|mem)_reset_dev()
acx(pci|mem)_verify_init()
acx(pci|mem)_process_rxdesc()
acx(pci|mem)_tx_data()
acx(pci|mem)_interrupt()   (comment diffs)
acx111(pci|mem)_ioctl_info() (extra printks in mem

---------
refactor struct acx_device

move (tx|rx)(host)?desc to sub-structure.
this will allow simplification of code doing buffer allocs and frees.

---------
move or copy (tbd) all proc files to debugfs

---------
acx_proc_show_eeprom(struct seq_file *file, void *v)

does seq_putc for buf, prbly a better/faster way.

---------
acxpci_read_eeprom_byte(acx_device_t * adev, u32 addr, u32 len,

add cpu-burn counter to assess wait-loop,
recode wait-loop to helper, replace multiple uses.

---------
compare load-firmware code to in-tree uses.
pci & mem both do this (see above)


DONE
---------
in acx_proc_show_eeprom(struct seq_file *file, void *v)
	// OW Hopefully enough. TODO see if eeprom fns can size it
	const int buf_size = 1024*64;

large malloc.  can push sizing down to callees, and return *buf

acxpci_proc_eeprom_output(buf, adev);
  only uses 0x400, so yes, here.

acxmem_proc_eeprom_output(buf, adev);
  uses 0xffff


